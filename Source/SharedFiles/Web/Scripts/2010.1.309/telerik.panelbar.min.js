(function(b){var a=b.telerik;var c={single:0,multi:1};b.extend(a,{panelbar:function(d,e){this.element=d;b.extend(this,e);b(":not(.t-state-disabled) > .t-link",d).live("click",a.delegate(this,this._click)).live("mouseenter",a.hover).live("mouseleave",a.leave);a.bind(this,{expand:this.onExpand,collapse:this.onCollapse,select:this.onSelect,error:this.onError,load:this.onLoad});var f=b(this.element).find("li.t-state-active > .t-content");if(f.length>0&&b(f[0]).children().length==0){this.expand(f.parent())}a.trigger(d,"load")}});b.extend(a.panelbar.prototype,{expand:function(d){b(d).each(b.proxy(function(g,f){var e=b(f);if(!e.hasClass(".t-state-disabled")&&e.find("> .t-group, > .t-content").length>0){if(this.expandMode==c.single&&this._collapseAllExpanded(e)){return}this._toggleItem(e,false,null)}},this))},collapse:function(d){b(d).each(b.proxy(function(g,f){var e=b(f);if(!e.hasClass(".t-state-disabled")&&e.find("> .t-group, > .t-content").is(":visible")){this._toggleItem(e,true,null)}},this))},toggle:function(d,e){b(d).each(function(){b(this).toggleClass("t-state-default",e).toggleClass("t-state-disabled",!e)})},enable:function(d){this.toggle(d,true)},disable:function(d){this.toggle(d,false)},_click:function(j,i){if(b(j.target).closest(".t-link")[0]!=i){return}var f=b(i);var h=f.closest(".t-item");b(".t-link",this.element).removeClass("t-state-selected");f.addClass("t-state-selected");if(a.trigger(this.element,"select",{item:h[0]})){j.preventDefault()}var k=h.find("> .t-content, > .t-group");var d=f.attr("href");if((d&&(d.charAt(d.length-1)=="#"||d.indexOf("#"+this.element.id+"-")!=-1))||(k.length>0&&k.children().length==0)){j.preventDefault()}else{return}if(this.expandMode==c.single){if(this._collapseAllExpanded(h)){return}}if(k.length!=0){var g=k.is(":visible");a.trigger(this.element,!g?"expand":"collapse",{item:h[0]});this._toggleItem(h,g,j)}},_toggleItem:function(f,d,i){var j=f.find("> .t-group");if(j.length!=0){this._toggleGroup(j,d);if(i!=null){i.preventDefault()}}else{var h=f.parent().children().index(f);var g=f.find("> .t-content");if(g.length>0){if(i!=null){i.preventDefault()}if(b.trim(g.html()).length>0){this._toggleGroup(g,d)}else{this._ajaxRequest(f,g,d)}}}},_toggleGroup:function(d,e){if(d.data("animating")){return}d.data("animating",true).parent().toggleClass("t-state-default",e).toggleClass("t-state-active",!e).find("> .t-link > .t-icon").toggleClass("t-arrow-up",!e).toggleClass("t-arrow-down",e);a.fx[!e?"play":"rewind"](this.effects,d,null,function(){d.data("animating",false)})},_collapseAllExpanded:function(d){if(d.find("> .t-link").hasClass("t-header")){if(d.find("> .t-content, > .t-group").is(":visible")||d.find("> .t-content, > .t-group").length==0){return true}else{b(this.element).children().find("> .t-content, > .t-group").filter(function(){return b(this).is(":visible")}).each(b.proxy(function(f,e){this._toggleGroup(b(e),true)},this))}}},_ajaxRequest:function(e,g,d){var f=b(".t-arrow-up, .t-arrow-down",e);var h=setTimeout(function(){f.addClass("t-loading")},100);var i={};b.ajax({type:"GET",url:e.find(".t-link").attr("href"),dataType:"html",data:i,error:b.proxy(function(k,j){if(a.ajaxError(this.element,"error",k,j)){return}},this),complete:function(){clearTimeout(h);f.removeClass("t-loading")},success:b.proxy(function(l,j){g.html(l);this._toggleGroup(g,d);var k=g.prev(".t-link");k.data("ContentUrl",k.attr("href")).attr("href","#")},this)})}});b.fn.tPanelBar=function(d){d=b.extend({},b.fn.tPanelBar.defaults,d);return this.each(function(){d=b.meta?b.extend({},d,b(this).data()):d;if(!b(this).data("tPanelBar")){b(this).data("tPanelBar",new a.panelbar(this,d))}})};b.fn.tPanelBar.defaults={effects:a.fx.property.defaults("height")}})(jQuery);