var createShortUrl={init:function(D){$("input.largeTextBox[name=url]").watermark();$("input.largeTextBox[name=alias]").watermark();$.validator.addMethod("validAlias",function(I,H){return this.optional(H)||/^[a-zA-Z0-9]+$/.test(I)},"Alias is not valid, alias can only contain alphanumeric characters.");$("#create").validate({rules:{url:{required:true,url:true},alias:{validAlias:true}},messages:{url:{required:"Url cannot be blank.",url:"Url is not in valid format."}},submitHandler:function(I){var H={dataType:"json",beforeSubmit:function(){$("div.validationBox").hide();$("div.messageBox").hide();$("ul.form input").attr("disabled",true);$("ul.form input.largeButton").val("Wait...")},success:function(J){$("ul.form input").attr("disabled",false);$("ul.form input.largeButton").val("Shrink");if(J.model!=null){E(J.model);$("input.largeTextBox[name=url],input.largeTextBox[name=alias]").val("")}else{if(J.modelStates!=null){F("Please correct the following errors and try again.",J.modelStates)}}},error:function(L,J,M){$("ul.form input").attr("disabled",false);$("ul.form input.largeButton").val("Shrink");var K={key:"form",errors:[]};K.errors[0]=L.statusText;F("An unexpected error has occurred, please try again.",new Array(K))}};$(I).ajaxSubmit(H);return false},errorClass:"input-validation-error",errorPlacement:B,highlight:G,unhighlight:A});function E(I){function H(P,M,O){var N=P.split(M);N=N.join(O);return N}var L='<span>Your new urls are generated successfully.</span><ul><li><div>Your shrinked urls are:</div><div><label for="newUrl">New:</label><input id="newUrl" type="text" value="{visitUrl}" readonly="readonly" class="largeTextBox readOnlyTextBox"/> ({visitUrlLength} characters) <a href="{visitUrl}" target="_blank">[opens in new window]</a></div><div><label for="previewUrl">Preview:</label><input id="previewUrl" type="text" value="{previewUrl}" readonly="readonly" class="largeTextBox readOnlyTextBox"/> <a href="{previewUrl}" target="_blank">[opens in new window]</a></div></li><li>Your original url was {url} ({urlLength} characters) <a href="{url}" target="_blank">[opens in new window]</a>.</li><li>We have made your url <strong>{reducedPercent}%</strong> (<strong>{reducedCharacters}</strong> characters) <strong>{type}</strong>.</li></ul>';var K=I.hasReduced?"shorter":"larger";var J=L;J=H(J,"{type}",K);J=H(J,"{reducedCharacters}",I.reducedCharacters);J=H(J,"{reducedPercent}",I.reducedPercent);J=H(J,"{urlLength}",I.url.length.toString());J=H(J,"{url}",I.url);J=H(J,"{previewUrl}",I.previewUrl);J=H(J,"{visitUrlLength}",I.visitUrl.length.toString());J=H(J,"{visitUrl}",I.visitUrl);$("div.messageBox").html(J).css({backgroundColor:"#e8e8e8"}).animate({opacity:"show"},"slow").animate({backgroundColor:"#c9ffca"},"slow").find("input.largeTextBox").focus(function(){this.select()})}function F(M,L){var K='<span class="validation-summary-errors">'+M+'</span><ul class="validation-summary-errors">';for(var J=0;J<L.length;J++){var I=$("#"+L[J].key);var N=C(L[J].errors[0]);I.addClass("input-validation-error");I.next("span:first").addClass("field-validation-error").html(N).fadeIn("slow");for(var H=0;H<L[J].errors.length;H++){K+='<li><label for="'+L[J].key+'">'+L[J].errors[H]+"</label></li>"}}K+="</ul>";$("div.validationBox").html(K).css({backgroundColor:"#e8e8e8"}).animate({opacity:"show"},"slow").animate({backgroundColor:"#f7cbca"},"slow")}function B(I,K){var H=I.text();if(K.is("input.largeTextBox[name=alias]")){H="Alias is not valid, alias can only contain alphanumeric characters."}var J=C(H);K.next("span:first").html(J)}function G(I,H){$(I).addClass(H).next("span:first").show()}function A(I,H){$(I).removeClass(H).next("span:first").hide()}function C(H){return'<img src="'+D+'" alt="" title="'+H+'"/>'}}};